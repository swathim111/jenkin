pipeline{
agent any
stages{
stage('Build'){
steps{
sh 'printenv'
}
}
stage('ecrlogin'){
steps{
withEnv (["AWS_ACCESS_KEY_ID-${env.AWS_ACCESS_KEY_ID}","AWS_SECRET_ACCESS_KEY-${env.AWS_SECRET_ACCESS_KEY}","AWS_DEFAULT_REGION-${env.AWS_DEFAULT_REGION}"])
{
sh 'docker login -u AWS -p $(aws ecr-public get-login-password --region us-east-1) public.ecr.aws/o4p0t3e5'
sh 'docker build -t ecr1 .'
sh 'docker tag ecr1:latest public.ecr.aws/o4p0t3e5/ecr1:latest'
sh 'docker push public.ecr.aws/o4p0t3e5/ecr1:latest'
}
}
}
}
}
